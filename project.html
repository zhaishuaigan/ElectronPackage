<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electron打包工具</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            line-height: 1.6;
        }

       
    </style>
</head>
<body>
    

    <script>
        // 文件上传处理
        function setupFileUpload(inputId, uploadId, textId, successText) {
            const input = document.getElementById(inputId);
            const upload = document.getElementById(uploadId);
            const text = document.getElementById(textId);

            input.addEventListener('change', function(e) {
                const files = e.target.files;
                if (files.length > 0) {
                    upload.classList.add('has-file');
                    if (input.webkitdirectory) {
                        const folderName = files[0].webkitRelativePath.split('/')[0];
                        text.textContent = `已选择: ${folderName}`;
                    } else {
                        text.textContent = `已选择: ${files[0].name}`;
                    }
                } else {
                    upload.classList.remove('has-file');
                    text.textContent = successText;
                }
            });

            upload.addEventListener('click', function() {
                input.click();
            });
        }

        // 初始化文件上传
        setupFileUpload('projectDir', 'projectDirUpload', 'projectDirText', '点击选择项目目录');
        setupFileUpload('appIcon', 'appIconUpload', 'appIconText', '选择图标文件 (.ico, .png, .jpg)');
        setupFileUpload('outputDir', 'outputDirUpload', 'outputDirText', '选择输出目录');

        // 表单提交处理
        document.getElementById('electronForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const appName = document.getElementById('appName').value.trim();
            const projectDir = document.getElementById('projectDir').files;
            const outputDir = document.getElementById('outputDir').files;
            
            // 验证必填项
            if (!appName) {
                showStatus('请输入程序文件名', 'error');
                return;
            }
            
            if (projectDir.length === 0) {
                showStatus('请选择项目目录', 'error');
                return;
            }
            
            if (outputDir.length === 0) {
                showStatus('请选择输出目录', 'error');
                return;
            }

            // 开始打包
            startPackaging();
        });

        // 返回按钮
        document.getElementById('backBtn').addEventListener('click', function() {
            if (confirm('确定要返回吗？当前配置将会丢失。')) {
                showStatus('正在返回...', 'success');
                setTimeout(() => {
                    window.history.back();
                }, 1000);
            }
        });

        // 显示状态消息
        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = `status-message status-${type}`;
            statusElement.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 4000);
            }
        }

        // 开始打包过程
        function startPackaging() {
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressLabel = document.getElementById('progressLabel');
            const generateBtn = document.getElementById('generateBtn');
            
            // 显示进度条
            progressContainer.style.display = 'block';
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<span class="loading"></span>打包中...';
            
            const steps = [
                '正在分析项目结构...',
                '正在复制项目文件...',
                '正在安装依赖...',
                '正在编译应用...',
                '正在生成安装包...',
                '正在优化文件大小...',
                '打包完成！'
            ];
            
            let currentStep = 0;
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 12 + 3;
                
                if (progress >= (currentStep + 1) * (100 / steps.length)) {
                    currentStep++;
                    if (currentStep < steps.length) {
                        progressLabel.textContent = steps[currentStep];
                    }
                }
                
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    
                    setTimeout(() => {
                        progressContainer.style.display = 'none';
                        generateBtn.disabled = false;
                        generateBtn.innerHTML = '开始打包';
                        showStatus('🎉 打包成功！应用程序已保存到输出目录。', 'success');
                    }, 800);
                }
                
                progressFill.style.width = progress + '%';
            }, 300);
        }
    </script>
</body>
</html>